{% extends 'base.html' %}
{% block content %}
<div class="bg-white p-6 rounded-xl shadow-xl fade-in max-w-3xl mx-auto">
  <h2 class="text-2xl font-bold text-indigo-700 mb-4">Code Debugging Assistant ðŸ¤–</h2>

  <form id="ask-form" class="space-y-4">
    <textarea id="code-input" name="code" rows="8" placeholder="Paste your Python code here..." class="w-full border border-indigo-200 p-3 rounded-md font-mono text-sm resize-y focus:outline-none focus:ring-2 focus:ring-indigo-400"></textarea>

    <button type="submit" class="bg-indigo-600 hover:bg-indigo-700 text-white px-5 py-2 rounded-md transition">
      Debug 
    </button>
  </form>

  <div id="response-area" class="mt-6 p-4 bg-gray-50 border border-gray-200 rounded-md text-sm font-mono whitespace-pre-wrap text-gray-800"></div>
</div>

<script>
document.getElementById('ask-form').addEventListener('submit', async function (e) {
  e.preventDefault();
  const code = document.getElementById('code-input').value;

  const responseArea = document.getElementById('response-area');
  responseArea.textContent = "Thinking... ðŸ’­";

  const res = await fetch("{% url 'ask_gpt' %}", {
    method: 'POST',
    headers: {
      'Content-Type': 'application/json',
      'X-CSRFToken': '{{ csrf_token }}',
    },
    body: JSON.stringify({ code })
  });

  const data = await res.json();
  responseArea.textContent = data.reply || "No response.";
});
</script>
{% endblock %}
